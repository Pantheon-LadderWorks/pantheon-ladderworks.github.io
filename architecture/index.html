---
layout: null
---
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Cypher Framework - Living Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/assets/site.css">
    <style>
        body {
            /* font-family: 'Inter', sans-serif; -- Handled by site.css but keeping for safety if site.css fails to load or specific overwrite needed, actually site.css handles it. */
            /* background-color: #0f172a; -- Handled by site.css */
            /* color: #e2e8f0; -- Handled by site.css */
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        #architecture-map {
            width: 100%;
            flex-grow: 1;
            position: relative;
        }

        .controls {
            position: absolute;
            top: 20px;
            /* Relative to map container now */
            left: 20px;
            background-color: rgba(15, 23, 42, 0.9);
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 1px solid rgba(148, 163, 184, 0.1);
            backdrop-filter: blur(10px);
            z-index: 10;
            max-width: 320px;
        }
    </style>
</head>

<body>
    <!-- Header Included via Jekyll -->
    {% include header.html %}

    <div id="architecture-map">
        <div class="controls">
            <h1
                class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-400 mb-2">
                The Cypher FrameWork
            </h1>
            <h2 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-4">
                Anatomical Federation View
            </h2>
            <p class="text-sm text-gray-300 leading-relaxed mb-4">
                This visualization maps the <strong>Cypher Framework</strong> as a living organism.
                It represents the "Product" viewâ€”the publicly reproducible architecture available to developers.
            </p>
            <div class="space-y-2 text-xs text-gray-400">
                <div class="flex items-center">
                    <span class="w-3 h-3 rounded-full bg-red-500 mr-2"></span> Core (Head)
                </div>
                <div class="flex items-center">
                    <span class="w-3 h-3 rounded-full bg-blue-500 mr-2"></span> Systems (Body)
                </div>
                <div class="flex items-center">
                    <span class="w-3 h-3 rounded-full bg-emerald-500 mr-2"></span> Agents (Capabilities)
                </div>
                <div class="flex items-center">
                    <span class="w-3 h-3 rounded-full bg-amber-500 mr-2"></span> Stations (Infrastructure)
                </div>
            </div>
        </div>
    </div>

    <script>
        // Full Screen D3 Visualization
        const container = document.getElementById('architecture-map');
        const width = container.clientWidth;
        const height = container.clientHeight;

        const svg = d3.select("#architecture-map")
            .append("svg")
            .attr("width", "100%")
            .attr("height", "100%")
            .attr("viewBox", [0, 0, width, height]);

        // G container for zooming
        const g = svg.append("g");

        // Zoom behavior
        const zoom = d3.zoom()
            .scaleExtent([0.1, 4])
            .on("zoom", (event) => g.attr("transform", event.transform));

        svg.call(zoom);

        const simulation = d3.forceSimulation()
            .force("link", d3.forceLink().id(d => d.id).distance(150))
            .force("charge", d3.forceManyBody().strength(-500))
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("collide", d3.forceCollide().radius(d => d.radius + 10));

        // Load data relative to root
        d3.json("../assets/anatomy.json").then(function (graph) {

            const link = g.append("g")
                .selectAll("line")
                .data(graph.links)
                .join("line")
                .attr("stroke", "#475569") // Slate 600
                .attr("stroke-opacity", 0.4)
                .attr("stroke-width", d => Math.sqrt(d.value) * 1.5)
                .attr("stroke-dasharray", d => d.dashed ? "5,5" : "none");

            const node = g.append("g")
                .selectAll("circle")
                .data(graph.nodes)
                .join("circle")
                .attr("r", d => d.radius * 1.2) // Slightly larger for full screen
                .attr("fill", d => getNodeColor(d.group))
                .attr("stroke", "#1e293b") // Slate 800
                .attr("stroke-width", 2)
                .style("cursor", "grab")
                .call(drag(simulation));

            const label = g.append("g")
                .selectAll("text")
                .data(graph.nodes)
                .join("text")
                .text(d => d.label)
                .attr("x", 15)
                .attr("y", 4)
                .style("font-family", "Inter, sans-serif")
                .style("font-size", "14px")
                .style("font-weight", "500")
                .style("fill", "#f1f5f9") // Slate 100
                .style("pointer-events", "none")
                .style("text-shadow", "0 2px 4px rgba(0,0,0,0.5)");

            node.append("title")
                .text(d => d.label + "\n" + d.group);

            simulation.nodes(graph.nodes).on("tick", ticked);
            simulation.force("link").links(graph.links);

            function ticked() {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                node
                    .attr("cx", d => d.x)
                    .attr("cy", d => d.y);

                label
                    .attr("x", d => d.x + (d.radius * 1.2) + 5)
                    .attr("y", d => d.y + 4);
            }

            function drag(simulation) {
                function dragstarted(event) {
                    if (!event.active) simulation.alphaTarget(0.3).restart();
                    event.subject.fx = event.subject.x;
                    event.subject.fy = event.subject.y;
                    d3.select(this).style("cursor", "grabbing");
                }

                function dragged(event) {
                    event.subject.fx = event.x;
                    event.subject.fy = event.y;
                }

                function dragended(event) {
                    if (!event.active) simulation.alphaTarget(0);
                    event.subject.fx = null;
                    event.subject.fy = null;
                    d3.select(this).style("cursor", "grab");
                }

                return d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended);
            }

            function getNodeColor(group) {
                const colors = {
                    "core": "#ef4444",      // Red
                    "system": "#3b82f6",    // Blue
                    "agent": "#10b981",     // Emerald
                    "council": "#8b5cf6",   // Violet
                    "station": "#f59e0b",   // Amber
                    "memory": "#ec4899",    // Pink
                    "spark": "#eab308"      // Yellow
                };
                return colors[group] || "#94a3b8";
            }
        });
    </script>
</body>

</html>